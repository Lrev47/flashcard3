<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Resume - <%= resume.name %></title>
</head>
<body>
  <div class="container">

    <!-- Resume Header -->
    <header>
      <!-- Hidden Metadata -->
      <div class="metadata">
        <p><strong>Resume ID:</strong> <%= resume.id %></p>
        <p><strong>User ID:</strong> <%= resume.userId %></p>
        <p><strong>Created At:</strong> <%= resume.createdAt %></p>
        <p><strong>Last Updated:</strong> <%= resume.updatedAt %></p>
      </div>

      <!-- Publicly Displayed Fields -->
      <h1><%= resume.name %></h1>
      <div class="contact-info">
        <% if (resume.city || resume.state || resume.zip) { %>
          <p>
            <strong>Location:</strong>
            <%= resume.city ? resume.city : '' %>
            <% if (resume.city && resume.state) { %>, <% } %>
            <%= resume.state ? resume.state : '' %>
            <%= resume.zip ? resume.zip : '' %>
          </p>
        <% } %>
        <% if (resume.phone) { %>
          <p><strong>Phone:</strong> <%= resume.phone %></p>
        <% } %>
        <% if (resume.email) { %>
          <p>
            <strong>Email:</strong>
            <a href="mailto:<%= resume.email %>"><%= resume.email %></a>
          </p>
        <% } %>
        <% if (resume.linkedinUrl) { %>
          <p>
            <strong>LinkedIn:</strong>
            <a href="<%= resume.linkedinUrl %>" target="_blank"><%= resume.linkedinUrl %></a>
          </p>
        <% } %>
        <% if (resume.githubUrl) { %>
          <p>
            <strong>GitHub:</strong>
            <a href="<%= resume.githubUrl %>" target="_blank"><%= resume.githubUrl %></a>
          </p>
        <% } %>
      </div>
      <% if (resume.summary) { %>
        <p><%= resume.summary %></p>
      <% } %>
    </header>

    <!-- Education Section -->
    <% if (resume.education && resume.education.length > 0) { %>
    <section id="education">
      <h2>Education</h2>
      <% resume.education.forEach(function(edu) { %>
      <div class="item">
        <h3><%= edu.institution %></h3>
        <p>
          <strong>Degree:</strong> <%= edu.degree ? edu.degree : '' %>
          <% if (edu.fieldOfStudy) { %> in <%= edu.fieldOfStudy %> <% } %>
        </p>
        <p class="dates">
          <%= edu.startDate ? new Date(edu.startDate).toDateString() : '' %> –
          <%= edu.endDate ? new Date(edu.endDate).toDateString() : 'Present' %>
        </p>
        <% if (edu.bulletPoints && edu.bulletPoints.length > 0) { %>
          <ul>
            <% edu.bulletPoints.forEach(function(bullet) { %>
            <li><%= bullet %></li>
            <% }); %>
          </ul>
        <% } %>
        <div class="metadata">
          <p><strong>Created At:</strong> <%= edu.createdAt %></p>
          <p><strong>Last Updated:</strong> <%= edu.updatedAt %></p>
        </div>
      </div>
      <% }); %>
    </section>
    <% } %>

    <!-- Experience Section -->
    <% if (resume.experiences && resume.experiences.length > 0) { %>
    <section id="experience">
      <h2>Experience</h2>
      <% resume.experiences.forEach(function(exp) { %>
      <div class="item">
        <h3><%= exp.roleTitle %></h3>
        <p>
          <strong>Company:</strong> <%= exp.company %>
        </p>
        <% if (exp.location) { %>
          <p>
            <strong>Location:</strong> <%= exp.location %>
          </p>
        <% } %>
        <p class="dates">
          <%= exp.startDate ? new Date(exp.startDate).toDateString() : '' %> –
          <%= exp.endDate ? new Date(exp.endDate).toDateString() : 'Present' %>
        </p>
        <% if (exp.responsibilities && exp.responsibilities.length > 0) { %>
          <ul>
            <% exp.responsibilities.forEach(function(resp) { %>
            <li><%= resp %></li>
            <% }); %>
          </ul>
        <% } %>
        <div class="metadata">
          <p><strong>Created At:</strong> <%= exp.createdAt %></p>
          <p><strong>Last Updated:</strong> <%= exp.updatedAt %></p>
        </div>
      </div>
      <% }); %>
    </section>
    <% } %>

    <!-- Projects Section -->
    <% if (resume.projects && resume.projects.length > 0) { %>
    <section id="projects">
      <h2>Projects</h2>
      <% resume.projects.forEach(function(proj) { %>
      <div class="item">
        <h3><%= proj.title %></h3>
        <% if (proj.technologiesUsed && proj.technologiesUsed.length > 0) { %>
          <p>
            <strong>Technologies Used:</strong>
            <%= proj.technologiesUsed.join(', ') %>
          </p>
        <% } %>
        <% if (proj.bulletPoints && proj.bulletPoints.length > 0) { %>
          <ul>
            <% proj.bulletPoints.forEach(function(point) { %>
            <li><%= point %></li>
            <% }); %>
          </ul>
        <% } %>
        <div class="metadata">
          <p><strong>Created At:</strong> <%= proj.createdAt %></p>
          <p><strong>Last Updated:</strong> <%= proj.updatedAt %></p>
        </div>
      </div>
      <% }); %>
    </section>
    <% } %>

    <!-- Skills Section -->
    <% if (resume.skillGroups && resume.skillGroups.length > 0) { %>
    <section id="skills">
      <h2>Skills</h2>
      <% resume.skillGroups.forEach(function(skillGroup) { %>
      <div class="item">
        <h3><%= skillGroup.name %></h3>
        <% if (skillGroup.skills && skillGroup.skills.length > 0) { %>
          <p><%= skillGroup.skills.join(', ') %></p>
        <% } %>
        <div class="metadata">
          <p><strong>Created At:</strong> <%= skillGroup.createdAt %></p>
          <p><strong>Last Updated:</strong> <%= skillGroup.updatedAt %></p>
        </div>
      </div>
      <% }); %>
    </section>
    <% } %>

  </div>
</body>
</html>
