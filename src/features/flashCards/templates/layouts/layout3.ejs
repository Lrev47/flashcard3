<!-- /src/features/flashCards/templates/layouts/layout3.ejs -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Flashcard PDF (Baseball Card 2.5×3.5 layout)</title>

  <style><%- themeCSS %></style>

  <style>
    @page {
      size: Letter;
      margin: 0;
    }
    html, body {
      margin: 0;
      padding: 0;
      width: 8.5in;
      height: 11in;
      font-family: Arial, sans-serif;
    }

    .page {
      position: relative;
      width: 8.5in;
      height: 11in;
      page-break-after: always;
      page-break-inside: avoid;
      overflow: hidden;
    }

    /*
      9 cards per page: 3 columns × 3 rows.
      Each final card: 2.5" wide × 3.5" tall.
      We'll rotate the front side -90°, so the slot is 3.5in wide × 2.5in tall.
    */

    .card-slot {
      position: absolute;
      width: 3.5in;   /* unrotated width */
      height: 2.5in;  /* unrotated height */
      page-break-inside: avoid;
      overflow: hidden;
    }

    /*
      Let's do a 0.5in top margin, 0.5in left margin.
      Then each column is 3.5in wide, so columns at left positions: 0.5in, 4.0in, 7.5in? 
      That would exceed 8.5 though. Actually 0.5 + 3.5 = 4.0, +3.5=7.5, that just fits at the right edge (no extra margin).
      For rows: top positions ~ 0.5in, 3.0in, 5.5in, 8.0in? 
      But we only want 3 rows total => top at 0.5in, 3.5in, 6.5in possibly. Then 2.5in tall each => 
      row1: 0.5 to 3.0
      row2: 3.5 to 6.0
      row3: 6.5 to 9.0
      That leaves 2" leftover at the bottom. 
      We'll keep it simple: 3 rows at top=0.5, 3.5, 6.5. 
    */

    /* Row 1 */
    .card-slot1  { top: 0.5in; left: 0.5in; }
    .card-slot2  { top: 0.5in; left: 4.0in; }
    .card-slot3  { top: 0.5in; left: 7.5in; }
    /* Row 2 */
    .card-slot4  { top: 3.5in; left: 0.5in; }
    .card-slot5  { top: 3.5in; left: 4.0in; }
    .card-slot6  { top: 3.5in; left: 7.5in; }
    /* Row 3 */
    .card-slot7  { top: 6.5in; left: 0.5in; }
    .card-slot8  { top: 6.5in; left: 4.0in; }
    .card-slot9  { top: 6.5in; left: 7.5in; }

    /* Rotate front side -90°. */
    .rotated-card {
      width: 2.5in;
      height: 3.5in;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-90deg);
      transform-origin: center center;
      page-break-inside: avoid;
    }

    /* Back side +90°. Swap columns. */
    .page-back .rotated-card {
      transform: translate(-50%, -50%) rotate(90deg);
    }

    .page-back .card-slot1  { top: 0.5in; left: 7.5in; }
    .page-back .card-slot2  { top: 0.5in; left: 4.0in; }
    .page-back .card-slot3  { top: 0.5in; left: 0.5in; }
    .page-back .card-slot4  { top: 3.5in; left: 7.5in; }
    .page-back .card-slot5  { top: 3.5in; left: 4.0in; }
    .page-back .card-slot6  { top: 3.5in; left: 0.5in; }
    .page-back .card-slot7  { top: 6.5in; left: 7.5in; }
    .page-back .card-slot8  { top: 6.5in; left: 4.0in; }
    .page-back .card-slot9  { top: 6.5in; left: 0.5in; }
  </style>
</head>
<body>

<%
  // 9 cards per chunk
  function getCard(cards, idx) {
    return (idx >= 0 && idx < cards.length) ? cards[idx] : null;
  }

  for (let i = 0; i < cards.length; i += 9) {
    const c0 = getCard(cards, i + 0);
    const c1 = getCard(cards, i + 1);
    const c2 = getCard(cards, i + 2);
    const c3 = getCard(cards, i + 3);
    const c4 = getCard(cards, i + 4);
    const c5 = getCard(cards, i + 5);
    const c6 = getCard(cards, i + 6);
    const c7 = getCard(cards, i + 7);
    const c8 = getCard(cards, i + 8);
%>

<!-- FRONT -->
<div class="page">
  <div class="card-slot card-slot1">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c0, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot2">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c1, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot3">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c2, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot4">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c3, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot5">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c4, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot6">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c5, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot7">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c6, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot8">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c7, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot9">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'front', card: c8, highlightCode }) %>
    </div>
  </div>
</div>

<!-- BACK -->
<div class="page page-back">
  <div class="card-slot card-slot1">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c0, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot2">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c1, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot3">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c2, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot4">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c3, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot5">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c4, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot6">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c5, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot7">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c6, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot8">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c7, highlightCode }) %>
    </div>
  </div>
  <div class="card-slot card-slot9">
    <div class="rotated-card">
      <%- include('../designs/' + style + '.ejs', { side: 'back', card: c8, highlightCode }) %>
    </div>
  </div>
</div>

<% } %>

</body>
</html>
